tidy(efgwinlm, conf.int = TRUE)
std_res <- rstandard(efgwinlm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(efgwinlm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(efgwinlm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
T3stat <- T3stat1819 %>% filter(Team != "Golden State Warriors")
efgwin2lm <- lm(W ~ eFG., data = T3stat)
summary(efgwin2lm)
tidy(efgwin2lm, conf.int = TRUE)
std_res <- rstandard(efgwin2lm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(efgwin2lm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(efgwin2lm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
efgwin2 <- ggplot(T3stat, aes(x = eFG., y = W )) + geom_point(colour = "#850c20") + geom_smooth(method = "lm", colour = "#0c8571") + labs(title = "Relationship Team Wins to Team EFG% 2018/2019", subtitle = "Outlier omitted", caption = "Data source: basketball-reference.com", x = "Team EFG%", y = "Number Wins") + geom_text(aes(label = Team))
efgwin2
x3pwin <- ggplot(T3stat1819, aes(x = X3P, y = W )) + geom_point(colour = "#850c20") + geom_smooth(method = "lm", colour = "#340c85") + labs(title = "Relationship Team Wins to Team Three Pointers 2018/2019", caption = "Data source: basketball-reference.com", x = "Team Three Pointers", y = "Number Wins") + geom_text(aes(label = Team))
x3pwin
x3pwinlm <- lm(W ~ X3P, data = T3stat1819)
summary(x3pwinlm)
tidy(x3pwinlm, conf.int = TRUE)
std_res <- rstandard(x3pwinlm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(x3pwinlm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(x3pwinlm)
cook_labels <- if_else(cook >= 0.125, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
T3statt <- T3stat1819 %>% filter(Team != "Washington Wizards" & Team != "Houston Rockets")
x3pwin2lm <- lm(W ~ X3P, data = T3statt)
summary(x3pwin2lm)
tidy(x3pwin2lm, conf.int = TRUE)
std_res <- rstandard(x3pwin2lm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(x3pwin2lm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(x3pwin2lm)
cook_labels <- if_else(cook >= 0.125, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
x3pwin2 <- ggplot(T3statt, aes(x = X3P, y = W )) + geom_point(colour = "#850c20") + geom_smooth(method = "lm", colour = "#340c85") + labs(title = "Relationship Team Wins to Team Three Pointers 2018/2019", subtitle = "Outliers omitted", caption = "Data source: basketball-reference.com", x = "Team Three Pointers", y = "Number Wins") + geom_text(aes(label = Team))
x3pwin2
astwin <- ggplot(T3stat1819, aes(x = AST, y = W )) + geom_point(colour = "#0c8571") + geom_smooth(method = "lm", colour = "#340c85") + labs(title = "Relationship Team Wins to Team Assists 2018/2019", caption = "Data source: basketball-reference.com", x = "Team Assists", y = "Number Wins") + geom_text(aes(label = Team))
astwin
astwinlm <- lm(W ~ AST, data = T3stat1819)
summary(astwinlm)
tidy(astwinlm, conf.int = TRUE)
std_res <- rstandard(astwinlm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(astwinlm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(astwinlm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
asttowin <- ggplot(T3stat1819, aes(x = AST_TOV, y = W )) + geom_point(colour = "#0c8571") + geom_smooth(method = "lm", colour = "#850c20") + labs(title = "Relationship Team Wins to Team Assists/Turnovers Ratio 2018/2019", caption = "Data source: basketball-reference.com", x = "Team Assist to Turnovers Ratio", y = "Number Wins") + geom_text(aes(label = Team))
asttowin
asttowinlm <- lm(W ~ AST_TOV, data = T3stat1819)
summary(asttowinlm)
tidy(asttowinlm, conf.int = TRUE)
std_res <- rstandard(asttowinlm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(asttowinlm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(asttowinlm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
rebwin <- ggplot(T3stat1819, aes(x = TRB, y = W )) + geom_point(colour = "#340c85") + geom_smooth(method = "lm", colour = "#850c20") + labs(title = "Relationship Team Wins to Rebounds 2018/2019", caption = "Data source: basketball-reference.com", x = "Total Rebounds", y = "Number Wins") + geom_text(aes(label = Team))
rebwin
rbwinlm <- lm(W ~ TRB, data = T3stat1819)
summary(rbwinlm)
tidy(rbwinlm, conf.int = TRUE)
std_res <- rstandard(rbwinlm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(rbwinlm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(rbwinlm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
T3stattt <- T3stat1819 %>% filter(Team != "Houston Rockets")
rbwin2lm <- lm(W ~ TRB, data = T3stattt)
summary(rbwin2lm)
tidy(rbwin2lm, conf.int = TRUE)
std_res <- rstandard(rbwin2lm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(rbwin2lm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(rbwin2lm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
rebwin2 <- ggplot(T3stattt, aes(x = TRB, y = W )) + geom_point(colour = "#340c85") + geom_smooth(method = "lm", colour = "#850c20") + labs(title = "Relationship Team Wins to Rebounds 2018/2019", subtitle = "Outliers removed", caption = "Data source: basketball-reference.com", x = "Total Rebounds", y = "Number Wins") + geom_text(aes(label = Team))
rebwin2
efgpos <- Pstat1819max %>% ggplot(aes(x = Pos, y = eFG., colour = Pos)) + geom_boxplot() + labs(title = "Relevance of Effective Field Goal Percentage by Position", caption = "Data source: basketball-reference.com", x = "Position", y = "Effective Field Goal Percentage", colour = "Position") + theme(plot.title = element_text(hjust = 0.5)) + scale_y_continuous(limits = c(0,1))
efgpos
Pstat1819max <- filter(Pstat1819max, eFG. < 1.0)
Pstat1819max <- filter(Pstat1819max, eFG. > 0.55)
efgpos <- Pstat1819max %>% ggplot(aes(x = Pos, y = eFG., colour = Pos)) + geom_boxplot() + labs(title = "Relevance of Effective Field Goal Percentage by Position", subtitle = "Minimum EFG% 55%", caption = "Data source: basketball-reference.com", x = "Position", y = "Effective Field Goal Percentage", colour = "Position") + theme(plot.title = element_text(hjust = 0.5)) + scale_y_continuous(limits = c(0,1))
efgpos
Pstat1819max <- Pstat1819max %>% mutate(rebounds_min = TRB / MP, assists_min = AST / MP, X3P_min = X3P / MP, AST_TOV = AST / TOV)
shootguard <- filter(Pstat1819max, Pos == "SG" | Pos == "SG-PF")
knitr::kable(print(shootguard))
shootguard <- filter(shootguard, GS > 10)
shootguardtopstart <- shootguard %>% summarise(player_name, X3P_min) %>% arrange(desc(X3P_min))
knitr::kable(print(shootguardtopstart))
shootguardrebstart <- shootguard %>% summarise(player_name, rebounds_min) %>% arrange(desc(rebounds_min))
knitr::kable(print(shootguardrebstart))
shootguardtopstartusd <- shootguard %>% summarise(player_name, salary) %>% arrange(desc(salary))
knitr::kable(print(tail(shootguardtopstartusd)))
buddy <- shootguard %>% filter(player_name == "Buddy Hield")
knitr::kable(print(buddy))
smallforward <- filter(Pstat1819max, Pos == "SF")
str(smallforward)
smallforward <- filter(smallforward, GS > 10)
smallforwardreb <- smallforward %>% summarise(player_name, rebounds_min) %>% arrange(desc(rebounds_min))
knitr::kable(print(smallforwardreb))
smallforwardasttov <- smallforward %>% summarise(player_name, AST_TOV) %>% arrange(desc(AST_TOV))
knitr::kable(print(smallforwardasttov))
smallforwardusd <- smallforward %>% summarise(player_name, salary) %>% arrange(desc(salary))
knitr::kable(tail(smallforwardusd))
kyle <- smallforward %>% filter(player_name == "Kyle Anderson")
knitr::kable(print(kyle))
pointguard <- filter(Pstat1819max, Pos == "PG" & GS > 10)
knitr::kable(pointguard)
pointguardasttov <- pointguard %>% summarise(player_name, AST_TOV) %>% arrange(desc(AST_TOV))
knitr::kable(print(pointguardasttov))
pointguard3p <- pointguard %>% summarise(player_name, X3P_min) %>% arrange(desc(X3P_min))
knitr::kable(print(pointguard3p))
pointguardusd <- pointguard %>% summarise(player_name, salary) %>% arrange(desc(salary))
knitr::kable(print(pointguardusd))
dj <- pointguard %>% filter(player_name == "DJ Augustin")
knitr::kable(print(dj))
powerforward <- filter(Pstat1819max, Pos == "PF" | Pos == "SG-PF")
powerforward <- filter(powerforward, GS > 10)
knitr::kable(print(powerforward))
powerforwardefg <- powerforward %>% summarise(player_name, eFG.) %>% arrange(desc(eFG.))
knitr::kable(print(powerforwardefg))
powerforwardreb <- powerforward %>% summarise(player_name, rebounds_min) %>% arrange(desc(rebounds_min))
knitr::kable(print(powerforwardreb))
powerforwardusd <- powerforward %>% summarise(player_name, salary) %>% arrange(desc(salary))
knitr::kable(tail(powerforwardusd))
john <- powerforward %>% filter(player_name == "John Collins")
knitr::kable(print(john))
Centres <- filter(Pstat1819max, Pos == "C" & GS > 10)
knitr::kable(print(Centres))
centreefg <- Centres %>% summarise(player_name, eFG.) %>% arrange(desc(eFG.))
knitr::kable(print(centreefg))
centrereb <- Centres %>% summarise(player_name, rebounds_min) %>% arrange(desc(rebounds_min))
knitr::kable(print(centrereb))
rudy <- Centres %>% filter(player_name == "Rudy Gobert")
knitr::kable(print(rudy))
fourpos <- 118000000 - 8641000 - 7250000 - 3833760 - 2299080
fourpos
median <- median(Pstat1819max$salary)
median
mean <- mean(Pstat1819max$salary)
mean
remaining <- 95976160 - 23491573
remaining
df1 <- data.frame("name" = c("LeBron James","Team"), "G" = c(67,0),
"GS" = c(62,0), "MP" = c(2316,0),"FG" = c(643,0), "FGA" = c(1303,0),
"Percentage FG" = c(0.493,0), "3P" = c(148,0), "3PA" = c(425,0),
"Percentage 3P" = c(0.348,0), "2P" = c(495,0), "2PA" = c(878,0),
"Percentage 2P" = c(0.564,0),"FT" = c(264,0), "FTA FG" = c(381,0),
"Percentage FT" = c(0.693,0), "ORB" = c(66,0),"DRB" = c(459,0),
"TRB" = c(525,0), "AST" = c(684,0), "STL" = c(78,0),
"BLK" = c(36,0),"TOV" = c(261,0), "PF" = c(118,0),
"PTS" = c(1698,0), "+/-" = c(0,0))
view(df1)
team <- Pstat1819max %>% filter(player_name == "Rudy Gobert" | player_name == "Kyle Anderson" | player_name == "DJ Augustin" | player_name == "Buddy Hield" | player_name == "John Collins")
team <- team %>% rename(name = player_name, Percentage.FG = FG.,Percentage.3P = X3P., Percentage.2P = X2P., FTA.FG = FTA, Percentage.FT = FT.)
teama <- team %>% select(name, G, GS, MP, FG, FGA, Percentage.FG, X3P, X3PA, Percentage.3P, X2P, X2PA, Percentage.2P, FT, FTA.FG, Percentage.FT, ORB, DRB, TRB, AST, STL, BLK, TOV, PF, PTS)
X... <- c(0, 0, 0, 0, 0)
teama <- teama %>% cbind(X...) %>% rename(X... = ...26)
team_stats(teama)
knitr::kable(print(teama))
Milwaukee <- Pstat1819max %>% filter(Tm == "MIL" & GS > 10)
print(Milwaukee)
Milwaukee <- Pstat1819 %>% filter(Tm =="MIL") %>% slice_max(GS, n = 5)
knitr::kable(print(Milwaukee))
teamb <- Milwaukee %>% rename(name = player_name, Percentage.FG = FG.,Percentage.3P = X3P., Percentage.2P = X2P., FTA.FG = FTA, Percentage.FT = FT.)
teamb <- teamb %>% select(name, G, GS, MP, FG, FGA, Percentage.FG, X3P, X3PA, Percentage.3P, X2P, X2PA, Percentage.2P, FT, FTA.FG, Percentage.FT, ORB, DRB, TRB, AST, STL, BLK, TOV, PF, PTS)
X... <- c(0, 0, 0, 0, 0)
teamb <- teamb %>% cbind(X...)
team_stats(teamb)
knitr::kable(print(teamb))
teambb <- team_stats(teamb)
teamaa <- team_stats(teama)
outcome <- team_advanced_stats(teamaa, teambb, 48)
knitr::kable(print(outcome))
knitr::kable(print(T1stat1819))
library(rmarkdown)
library(knitr)
library(tidyverse)
library(broom)
library(ggplot2)
library(AdvancedBasketballStats)
Pstat1819 <- read.csv("data/raw/2018-19_nba_player-statistics.csv")
T1stat1819 <- read.csv("data/raw/2018-19_nba_team-statistics_1.csv")
T2stat1819 <- read.csv("data/raw/2018-19_nba_team-statistics_2.csv")
Psal1819 <- read.csv("data/raw/2018-19_nba_player-salaries.csv")
Tpay1920 <- read.csv("data/raw/2019-20_nba_team-payroll.csv")
str(Pstat1819)
knitr::kable(head(Pstat1819))
knitr::kable(tail(Pstat1819))
Pstat1819 <- transform(Pstat1819, Pos = as.factor(Pos), Tm = as.factor(Tm))
(is.na(Pstat1819))
colnames(Pstat1819)[colSums(is.na(Pstat1819)) > 0]
Pstat1819[is.na(Pstat1819)] = 0
(T1stat1819)
knitr::kable(head(T1stat1819))
knitr::kable(tail(T1stat1819))
which(is.na(T1stat1819))
colnames(T1stat1819)[colSums(is.na(T1stat1819)) > 0]
T1stat1819 <- select(T1stat1819, -c(X, X.1, X.2))
str(T2stat1819)
knitr::kable(head(T2stat1819))
knitr::kable(tail(T2stat1819))
which(is.na(T2stat1819))
str(Psal1819)
knitr::kable(head(Psal1819))
knitr::kable(tail(Psal1819))
which(is.na(Psal1819))
retired <- c("Channing Frye", "Dwyane Wade", "Dirk Nowitzki", "Tony Parker", "Darren Collison", "Zaza Pachulia", "Shaun Livingston", "Luol Deng", "Jose Calderon", "Marcin Gortat", "Jon Leuer")
Pstat1819 <- Pstat1819 %>% filter(!player_name %in% retired)
Pstat1819max <- Pstat1819 %>% group_by(player_name) %>% slice(which.max(PTS))
str(Pstat1819max)
Pstat1819max <- Pstat1819max %>% left_join(Psal1819, by = "player_name")
which(is.na(Pstat1819max))
colnames(Pstat1819max)[colSums(is.na(Pstat1819max)) > 0]
Pstat1819max <- Pstat1819max %>% filter(!is.na(salary))
T2stat1819 <- T2stat1819 %>% mutate(AST_TOV = AST / TOV)
T3stat1819 <- T2stat1819 %>% left_join(T1stat1819, by = "Team")
efgwin <- ggplot(T3stat1819, aes(x = eFG., y = W )) + geom_point(colour = "#850c20") + geom_smooth(method = "lm", colour = "#0c8571") + labs(title = "Relationship Team Wins to Team EFG% 2018/2019", caption = "Data source: basketball-reference.com", x = "Team EFG%", y = "Number Wins") + geom_text(aes(label = Team))
efgwin
efgwinlm <- lm(W ~ eFG., data = T3stat1819)
summary(efgwinlm)
tidy(efgwinlm, conf.int = TRUE)
std_res <- rstandard(efgwinlm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(efgwinlm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(efgwinlm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
T3stat <- T3stat1819 %>% filter(Team != "Golden State Warriors")
efgwin2lm <- lm(W ~ eFG., data = T3stat)
summary(efgwin2lm)
tidy(efgwin2lm, conf.int = TRUE)
std_res <- rstandard(efgwin2lm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(efgwin2lm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(efgwin2lm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
efgwin2 <- ggplot(T3stat, aes(x = eFG., y = W )) + geom_point(colour = "#850c20") + geom_smooth(method = "lm", colour = "#0c8571") + labs(title = "Relationship Team Wins to Team EFG% 2018/2019", subtitle = "Outlier omitted", caption = "Data source: basketball-reference.com", x = "Team EFG%", y = "Number Wins") + geom_text(aes(label = Team))
efgwin2
x3pwin <- ggplot(T3stat1819, aes(x = X3P, y = W )) + geom_point(colour = "#850c20") + geom_smooth(method = "lm", colour = "#340c85") + labs(title = "Relationship Team Wins to Team Three Pointers 2018/2019", caption = "Data source: basketball-reference.com", x = "Team Three Pointers", y = "Number Wins") + geom_text(aes(label = Team))
x3pwin
x3pwinlm <- lm(W ~ X3P, data = T3stat1819)
summary(x3pwinlm)
tidy(x3pwinlm, conf.int = TRUE)
std_res <- rstandard(x3pwinlm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(x3pwinlm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(x3pwinlm)
cook_labels <- if_else(cook >= 0.125, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
T3statt <- T3stat1819 %>% filter(Team != "Washington Wizards" & Team != "Houston Rockets")
x3pwin2lm <- lm(W ~ X3P, data = T3statt)
summary(x3pwin2lm)
tidy(x3pwin2lm, conf.int = TRUE)
std_res <- rstandard(x3pwin2lm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(x3pwin2lm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(x3pwin2lm)
cook_labels <- if_else(cook >= 0.125, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
x3pwin2 <- ggplot(T3statt, aes(x = X3P, y = W )) + geom_point(colour = "#850c20") + geom_smooth(method = "lm", colour = "#340c85") + labs(title = "Relationship Team Wins to Team Three Pointers 2018/2019", subtitle = "Outliers omitted", caption = "Data source: basketball-reference.com", x = "Team Three Pointers", y = "Number Wins") + geom_text(aes(label = Team))
x3pwin2
astwin <- ggplot(T3stat1819, aes(x = AST, y = W )) + geom_point(colour = "#0c8571") + geom_smooth(method = "lm", colour = "#340c85") + labs(title = "Relationship Team Wins to Team Assists 2018/2019", caption = "Data source: basketball-reference.com", x = "Team Assists", y = "Number Wins") + geom_text(aes(label = Team))
astwin
astwinlm <- lm(W ~ AST, data = T3stat1819)
summary(astwinlm)
tidy(astwinlm, conf.int = TRUE)
std_res <- rstandard(astwinlm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(astwinlm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(astwinlm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
asttowin <- ggplot(T3stat1819, aes(x = AST_TOV, y = W )) + geom_point(colour = "#0c8571") + geom_smooth(method = "lm", colour = "#850c20") + labs(title = "Relationship Team Wins to Team Assists/Turnovers Ratio 2018/2019", caption = "Data source: basketball-reference.com", x = "Team Assist to Turnovers Ratio", y = "Number Wins") + geom_text(aes(label = Team))
asttowin
asttowinlm <- lm(W ~ AST_TOV, data = T3stat1819)
summary(asttowinlm)
tidy(asttowinlm, conf.int = TRUE)
std_res <- rstandard(asttowinlm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(asttowinlm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(asttowinlm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
rebwin <- ggplot(T3stat1819, aes(x = TRB, y = W )) + geom_point(colour = "#340c85") + geom_smooth(method = "lm", colour = "#850c20") + labs(title = "Relationship Team Wins to Rebounds 2018/2019", caption = "Data source: basketball-reference.com", x = "Total Rebounds", y = "Number Wins") + geom_text(aes(label = Team))
rebwin
rbwinlm <- lm(W ~ TRB, data = T3stat1819)
summary(rbwinlm)
tidy(rbwinlm, conf.int = TRUE)
std_res <- rstandard(rbwinlm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(rbwinlm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(rbwinlm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
T3stattt <- T3stat1819 %>% filter(Team != "Houston Rockets")
rbwin2lm <- lm(W ~ TRB, data = T3stattt)
summary(rbwin2lm)
tidy(rbwin2lm, conf.int = TRUE)
std_res <- rstandard(rbwin2lm)
points <- 1:length(std_res)
sdplot <- ggplot(data = NULL, aes(x = points, y = std_res)) + geom_point() + ylim(c(-4,4)) + geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
sdplot
hats <- hatvalues(rbwin2lm)
hat_labels <- if_else(hats >= 0.15, paste(points),"")
hatplot <- ggplot(data = NULL, aes(x = points, y = hats)) + geom_point() + geom_text(aes(label = hat_labels), nudge_y = 0.005)
hatplot
cook <- cooks.distance(rbwin2lm)
cook_labels <- if_else(cook >= 0.2, paste(points),"")
cookplot <- ggplot(data = NULL, aes(x = points, y = cook)) + geom_point() + geom_text(aes(label = cook_labels), nudge_y = 0.005)
cookplot
rebwin2 <- ggplot(T3stattt, aes(x = TRB, y = W )) + geom_point(colour = "#340c85") + geom_smooth(method = "lm", colour = "#850c20") + labs(title = "Relationship Team Wins to Rebounds 2018/2019", subtitle = "Outliers removed", caption = "Data source: basketball-reference.com", x = "Total Rebounds", y = "Number Wins") + geom_text(aes(label = Team))
rebwin2
efgpos <- Pstat1819max %>% ggplot(aes(x = Pos, y = eFG., colour = Pos)) + geom_boxplot() + labs(title = "Relevance of Effective Field Goal Percentage by Position", caption = "Data source: basketball-reference.com", x = "Position", y = "Effective Field Goal Percentage", colour = "Position") + theme(plot.title = element_text(hjust = 0.5)) + scale_y_continuous(limits = c(0,1))
efgpos
Pstat1819max <- filter(Pstat1819max, eFG. < 1.0)
Pstat1819max <- filter(Pstat1819max, eFG. > 0.55)
efgpos <- Pstat1819max %>% ggplot(aes(x = Pos, y = eFG., colour = Pos)) + geom_boxplot() + labs(title = "Relevance of Effective Field Goal Percentage by Position", subtitle = "Minimum EFG% 55%", caption = "Data source: basketball-reference.com", x = "Position", y = "Effective Field Goal Percentage", colour = "Position") + theme(plot.title = element_text(hjust = 0.5)) + scale_y_continuous(limits = c(0,1))
efgpos
Pstat1819max <- Pstat1819max %>% mutate(rebounds_min = TRB / MP, assists_min = AST / MP, X3P_min = X3P / MP, AST_TOV = AST / TOV)
shootguard <- filter(Pstat1819max, Pos == "SG" | Pos == "SG-PF")
knitr::kable(print(shootguard))
shootguard <- filter(shootguard, GS > 10)
shootguardtopstart <- shootguard %>% summarise(player_name, X3P_min) %>% arrange(desc(X3P_min))
knitr::kable(print(shootguardtopstart))
shootguardrebstart <- shootguard %>% summarise(player_name, rebounds_min) %>% arrange(desc(rebounds_min))
knitr::kable(print(shootguardrebstart))
shootguardtopstartusd <- shootguard %>% summarise(player_name, salary) %>% arrange(desc(salary))
knitr::kable(print(tail(shootguardtopstartusd)))
buddy <- shootguard %>% filter(player_name == "Buddy Hield")
knitr::kable(print(buddy))
smallforward <- filter(Pstat1819max, Pos == "SF")
str(smallforward)
smallforward <- filter(smallforward, GS > 10)
smallforwardreb <- smallforward %>% summarise(player_name, rebounds_min) %>% arrange(desc(rebounds_min))
knitr::kable(print(smallforwardreb))
smallforwardasttov <- smallforward %>% summarise(player_name, AST_TOV) %>% arrange(desc(AST_TOV))
knitr::kable(print(smallforwardasttov))
smallforwardusd <- smallforward %>% summarise(player_name, salary) %>% arrange(desc(salary))
knitr::kable(tail(smallforwardusd))
kyle <- smallforward %>% filter(player_name == "Kyle Anderson")
knitr::kable(print(kyle))
pointguard <- filter(Pstat1819max, Pos == "PG" & GS > 10)
knitr::kable(pointguard)
pointguardasttov <- pointguard %>% summarise(player_name, AST_TOV) %>% arrange(desc(AST_TOV))
knitr::kable(print(pointguardasttov))
pointguard3p <- pointguard %>% summarise(player_name, X3P_min) %>% arrange(desc(X3P_min))
knitr::kable(print(pointguard3p))
pointguardusd <- pointguard %>% summarise(player_name, salary) %>% arrange(desc(salary))
knitr::kable(print(pointguardusd))
dj <- pointguard %>% filter(player_name == "DJ Augustin")
knitr::kable(print(dj))
powerforward <- filter(Pstat1819max, Pos == "PF" | Pos == "SG-PF")
powerforward <- filter(powerforward, GS > 10)
knitr::kable(print(powerforward))
powerforwardefg <- powerforward %>% summarise(player_name, eFG.) %>% arrange(desc(eFG.))
knitr::kable(print(powerforwardefg))
powerforwardreb <- powerforward %>% summarise(player_name, rebounds_min) %>% arrange(desc(rebounds_min))
knitr::kable(print(powerforwardreb))
powerforwardusd <- powerforward %>% summarise(player_name, salary) %>% arrange(desc(salary))
knitr::kable(tail(powerforwardusd))
john <- powerforward %>% filter(player_name == "John Collins")
knitr::kable(print(john))
Centres <- filter(Pstat1819max, Pos == "C" & GS > 10)
knitr::kable(print(Centres))
centreefg <- Centres %>% summarise(player_name, eFG.) %>% arrange(desc(eFG.))
knitr::kable(print(centreefg))
centrereb <- Centres %>% summarise(player_name, rebounds_min) %>% arrange(desc(rebounds_min))
knitr::kable(print(centrereb))
rudy <- Centres %>% filter(player_name == "Rudy Gobert")
knitr::kable(print(rudy))
fourpos <- 118000000 - 8641000 - 7250000 - 3833760 - 2299080
fourpos
median <- median(Pstat1819max$salary)
median
mean <- mean(Pstat1819max$salary)
mean
remaining <- 95976160 - 23491573
remaining
df1 <- data.frame("name" = c("LeBron James","Team"), "G" = c(67,0),
"GS" = c(62,0), "MP" = c(2316,0),"FG" = c(643,0), "FGA" = c(1303,0),
"Percentage FG" = c(0.493,0), "3P" = c(148,0), "3PA" = c(425,0),
"Percentage 3P" = c(0.348,0), "2P" = c(495,0), "2PA" = c(878,0),
"Percentage 2P" = c(0.564,0),"FT" = c(264,0), "FTA FG" = c(381,0),
"Percentage FT" = c(0.693,0), "ORB" = c(66,0),"DRB" = c(459,0),
"TRB" = c(525,0), "AST" = c(684,0), "STL" = c(78,0),
"BLK" = c(36,0),"TOV" = c(261,0), "PF" = c(118,0),
"PTS" = c(1698,0), "+/-" = c(0,0))
view(df1)
team <- Pstat1819max %>% filter(player_name == "Rudy Gobert" | player_name == "Kyle Anderson" | player_name == "DJ Augustin" | player_name == "Buddy Hield" | player_name == "John Collins")
team <- team %>% rename(name = player_name, Percentage.FG = FG.,Percentage.3P = X3P., Percentage.2P = X2P., FTA.FG = FTA, Percentage.FT = FT.)
teama <- team %>% select(name, G, GS, MP, FG, FGA, Percentage.FG, X3P, X3PA, Percentage.3P, X2P, X2PA, Percentage.2P, FT, FTA.FG, Percentage.FT, ORB, DRB, TRB, AST, STL, BLK, TOV, PF, PTS)
X... <- c(0, 0, 0, 0, 0)
teama <- teama %>% cbind(X...) %>% rename(X... = ...26)
team_stats(teama)
knitr::kable(print(teama))
Milwaukee <- Pstat1819max %>% filter(Tm == "MIL" & GS > 10)
print(Milwaukee)
Milwaukee <- Pstat1819 %>% filter(Tm =="MIL") %>% slice_max(GS, n = 5)
knitr::kable(print(Milwaukee))
teamb <- Milwaukee %>% rename(name = player_name, Percentage.FG = FG.,Percentage.3P = X3P., Percentage.2P = X2P., FTA.FG = FTA, Percentage.FT = FT.)
teamb <- teamb %>% select(name, G, GS, MP, FG, FGA, Percentage.FG, X3P, X3PA, Percentage.3P, X2P, X2PA, Percentage.2P, FT, FTA.FG, Percentage.FT, ORB, DRB, TRB, AST, STL, BLK, TOV, PF, PTS)
X... <- c(0, 0, 0, 0, 0)
teamb <- teamb %>% cbind(X...)
team_stats(teamb)
knitr::kable(print(teamb))
teambb <- team_stats(teamb)
teamaa <- team_stats(teama)
outcome <- team_advanced_stats(teamaa, teambb, 48)
knitr::kable(print(outcome))
knitr::kable(print(T1stat1819))
